(this["webpackJsonpblog-author-interface"]=this["webpackJsonpblog-author-interface"]||[]).push([[0],{46:function(t,e,n){},48:function(t,e,n){"use strict";n.r(e);var c=n(0),o=n.n(c),a=n(18),r=n.n(a),i=n(3),s=n(15),j=n(4),u=n(26),l=n.n(u),b=n(1);function h(t){var e=Object(c.useState)(""),n=Object(i.a)(e,2),o=n[0],a=n[1],r=Object(c.useState)(""),s=Object(i.a)(r,2),j=s[0],u=s[1],h=Object(c.useState)(!1),d=Object(i.a)(h,2),O=d[0],m=d[1],f=Object(c.useState)(""),x=Object(i.a)(f,2),g=x[0],p=x[1],S=Object(c.useState)(""),v=Object(i.a)(S,2),k=v[0],y=v[1];return O?k?Object(b.jsxs)("p",{children:["Oops an error occured! ",k]}):Object(b.jsx)("p",{children:"Log in successful!"}):Object(b.jsxs)("div",{id:"loginform",children:[Object(b.jsx)("h3",{children:"Log in"}),Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/auth/login",{mode:"cors",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:j})}).then((function(t){return t.json()})).then((function(e){e.user?e.user&&(localStorage.setItem("token","Bearer ".concat(e.token)),m(!0),t.signal(!0)):p(e.info.message)})).catch((function(t){return y(t)}))},children:[Object(b.jsx)("input",{type:"text",name:"username",placeholder:"Username...",value:o,onChange:function(t){a(t.target.value)}}),Object(b.jsx)("input",{type:"password",name:"password",placeholder:"Password...",value:j,onChange:function(t){u(t.target.value)}}),Object(b.jsx)("div",{id:"loginbuttons",children:Object(b.jsx)("button",{id:"login",children:Object(b.jsx)(l.a,{})})}),Object(b.jsx)("p",{id:"message",children:g})]})]})}var d=n(33),O=n(16),m=n(22),f=n.n(m),x=n(21),g=n.n(x),p=n(28),S=n.n(p),v=n(29),k=n.n(v);function y(t){var e=t.data,n=Object(c.useState)(!1),o=Object(i.a)(n,2),a=o[0],r=o[1],j=Object(c.useState)(!1),u=Object(i.a)(j,2),l=u[0],h=u[1],d=Object(c.useState)(e.public),m=Object(i.a)(d,2),x=m[0],p=m[1];return l?"":Object(b.jsxs)("li",{className:"article",children:[Object(b.jsx)(s.b,{to:"/article/"+e._id,children:Object(b.jsx)("h4",{children:e.title})}),Object(b.jsx)("p",{children:O.DateTime.fromISO(e.timestamp).toLocaleString({day:"numeric",month:"long",hour:"numeric",hour12:!1,minute:"numeric"})}),Object(b.jsxs)("div",{className:"articlebuttons",children:[e.public||x?"":Object(b.jsx)("button",{onClick:function(){fetch("/blog/posts/".concat(e._id),{mode:"cors",method:"PUT",headers:{Authorization:localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify({title:e.title,content:e.content,public:!0})}).then((function(t){return t.json()})).then((function(t){e.public=!0,p(!0)})).catch((function(t){return console.log(t)}))},children:Object(b.jsx)(S.a,{})}),e.public&&x?Object(b.jsx)("button",{onClick:function(){fetch("/blog/posts/".concat(e._id),{mode:"cors",method:"PUT",headers:{Authorization:localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify({title:e.title,content:e.content,public:!1})}).then((function(t){return t.json()})).then((function(t){e.public=!1,p(!1)})).catch((function(t){return console.log(t)}))},children:Object(b.jsx)(k.a,{})}):"",Object(b.jsx)("button",{onClick:function(){r(!a)},children:a?Object(b.jsx)(g.a,{}):Object(b.jsx)(f.a,{})}),a?Object(b.jsx)("button",{onClick:function(){fetch("/blog/posts/".concat(e._id),{mode:"cors",method:"DELETE",headers:{Authorization:localStorage.getItem("token")}}).then((function(t){return t.json()})).then((function(t){t.message&&h(!0)})).catch((function(t){return console.log(t)}))},children:"Confirm"}):""]})]},e._id)}function C(t){var e=Object(c.useState)(""),n=Object(i.a)(e,2),o=n[0],a=n[1],r=Object(c.useState)(""),s=Object(i.a)(r,2),j=s[0],u=s[1],l=Object(c.useState)(!1),h=Object(i.a)(l,2),d=h[0],O=h[1],m=Object(c.useState)([]),f=Object(i.a)(m,2),x=f[0],g=f[1],p=Object(c.useState)(""),S=Object(i.a)(p,2),v=S[0],k=S[1];return Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/blog/posts",{mode:"cors",method:"POST",headers:{Authorization:localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify({title:o,content:j,public:!d})}).then((function(t){return t.json()})).then((function(e){e.errors?g(e.errors):(k(e.message),t.push(e.post),a(""),u(""),O(!1))})).catch((function(t){return console.log(t)}))},children:[Object(b.jsx)("input",{type:"text",name:"title",placeholder:"Title...",onChange:function(t){a(t.target.value)},value:o}),Object(b.jsx)("textarea",{name:"content",placeholder:"Content...",onChange:function(t){u(t.target.value)},value:j}),Object(b.jsx)("label",{htmlFor:"public",children:"Private:"}),Object(b.jsx)("input",{type:"checkbox",name:"public",value:d,onChange:function(t){O(t.target.checked)}}),Object(b.jsx)("button",{children:"Post"}),Object(b.jsx)("ul",{children:x.map((function(t){return Object(b.jsx)("li",{children:t.msg})}))}),v]})}var I=n(32),T=n.n(I),w=n(31),E=n.n(w),A=n(30),N=n.n(A);function L(t){var e=Object(c.useState)({}),n=Object(i.a)(e,2),o=n[0],a=n[1],r=Object(c.useState)(""),s=Object(i.a)(r,2),j=s[0],u=s[1],l=Object(c.useState)(!1),h=Object(i.a)(l,2),O=h[0],m=h[1],f=Object(c.useState)([]),x=Object(i.a)(f,2),g=x[0],p=x[1],S=Object(c.useState)(!1),v=Object(i.a)(S,2),k=v[0],I=v[1];return Object(c.useEffect)((function(){var t=new AbortController,e=t.signal;fetch("/blog/currentuser",{mode:"cors",headers:{Authorization:localStorage.getItem("token")},signal:e}).then((function(t){return t.json()})).then((function(e){a(e),t.abort()})).catch((function(e){u(e),m(!0),t.abort()})),fetch("/blog/posts/private",{mode:"cors",headers:{Authorization:localStorage.getItem("token")}}).then((function(t){return t.json()})).then((function(t){p(t),m(!0)})).catch((function(t){u(t),m(!0)}))}),[]),O?j?Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Oops! An error occured!"}),Object(b.jsx)("p",{children:j})]}):Object(b.jsxs)("div",{children:[Object(b.jsxs)("h2",{children:["Welcome ",o.authData.firstname,"!"]}),Object(b.jsx)("button",{id:"logout",onClick:function(){localStorage.removeItem("token"),window.location.href="/"},children:Object(b.jsx)(N.a,{})}),Object(b.jsx)("h3",{children:"Currently these are all of your articles:"}),Object(b.jsx)("button",{onClick:function(){I(!k)},name:"new",id:"new",children:k?Object(b.jsx)(E.a,{}):Object(b.jsx)(T.a,{})}),k?Object(b.jsx)(C,{push:function(t){p([].concat(Object(d.a)(g),[t]))}}):"",Object(b.jsx)("ul",{id:"articles",children:g.map((function(t){return Object(b.jsx)(y,{data:t},t._id)}))})]}):Object(b.jsx)("h2",{children:"Loading..."})}function _(t){var e=Object(c.useState)(!1),n=Object(i.a)(e,2),o=n[0],a=n[1],r=Object(c.useState)(""),s=Object(i.a)(r,2),j=s[0],u=s[1],l=t.data;return""===j?Object(b.jsxs)("div",{className:"comment",children:[Object(b.jsx)("h4",{children:l.name}),Object(b.jsx)("p",{children:l.content}),Object(b.jsx)("p",{id:"commenttimestamp",children:O.DateTime.fromISO(l.timestamp).toLocaleString({day:"numeric",month:"long",hour:"numeric",hour12:!1,minute:"numeric"})}),Object(b.jsxs)("div",{className:"commentbuttons",children:[Object(b.jsx)("button",{onClick:function(){a(!o)},children:o?Object(b.jsx)(g.a,{}):Object(b.jsx)(f.a,{})}),o?Object(b.jsx)("button",{onClick:function(){fetch("/blog/posts/".concat(t.articleId,"/comments/").concat(l._id),{mode:"cors",method:"DELETE",headers:{Authorization:localStorage.getItem("token")}}).then((function(t){return t.json()})).then((function(t){t.message&&u(t.message)})).catch((function(t){return console.log(t)}))},children:"Confirm"}):""]})]},l._id):Object(b.jsx)("h4",{children:j})}var D=function(){var t=Object(c.useState)(""),e=Object(i.a)(t,2),n=e[0],o=e[1],a=Object(c.useState)(""),r=Object(i.a)(a,2),s=r[0],u=r[1],l=Object(c.useState)(""),h=Object(i.a)(l,2),d=h[0],m=h[1],f=Object(c.useState)(""),x=Object(i.a)(f,2),g=x[0],p=x[1],S=Object(c.useState)([]),v=Object(i.a)(S,2),k=v[0],y=v[1],C=Object(c.useState)(null),I=Object(i.a)(C,2),T=I[0],w=I[1],E=Object(c.useState)(!1),A=Object(i.a)(E,2),N=A[0],L=A[1],D=Object(j.g)().id;return Object(c.useEffect)((function(){fetch("/blog/posts/".concat(D),{mode:"cors",method:"GET"}).then((function(t){return t.json()})).then((function(t){var e=t.post;o(e.title),u("".concat(e.author.firstname," ").concat(e.author.lastname)),m(O.DateTime.fromISO(e.timestamp).toLocaleString({day:"numeric",month:"long",hour:"numeric",hour12:!1,minute:"numeric"})),p(e.content),L(!0)})).catch((function(t){w(t),console.log(t),L(!0)})),fetch("/blog/posts/".concat(D,"/comments"),{mode:"cors",method:"GET"}).then((function(t){return t.json()})).then((function(t){t.error||y(t)})).catch((function(t){w(t),console.log(t)}))}),[D]),T?Object(b.jsxs)("div",{id:"error",children:[Object(b.jsx)("h1",{children:"An error occured!"}),Object(b.jsx)("p",{children:"Try reloading the page."})]}):N?Object(b.jsxs)("div",{id:"container",children:[Object(b.jsxs)("div",{id:"content",children:[Object(b.jsx)("h1",{children:n}),Object(b.jsx)("h2",{children:s}),Object(b.jsxs)("h4",{children:["Posted on ",d]}),Object(b.jsx)("p",{id:"articletext",children:g})]}),Object(b.jsx)("div",{id:"comments",children:k.map((function(t){return Object(b.jsx)(_,{articleId:D,data:t},t._id)}))})]}):Object(b.jsx)("div",{id:"loading",children:Object(b.jsx)("h1",{children:"Loading content..."})})};function P(){var t=Object(c.useState)(!1),e=Object(i.a)(t,2),n=e[0],o=e[1];return Object(b.jsxs)(s.a,{children:[Object(b.jsx)("nav",{children:Object(b.jsx)(s.b,{to:"/author-frontend/dashboard",children:Object(b.jsx)("h1",{className:"pagetitle",children:"Nico's Blog (author)"})})}),Object(b.jsxs)(j.d,{children:[Object(b.jsx)(j.b,{path:"/author-frontend",exact:!0,children:n||localStorage.getItem("token")?Object(b.jsx)(j.a,{to:"/author-frontend/dashboard"}):Object(b.jsx)(h,{signal:o})}),Object(b.jsx)(j.b,{path:"/author-frontend/dashboard",exact:!0,children:n||localStorage.getItem("token")?Object(b.jsx)(L,{}):Object(b.jsx)(h,{signal:o})}),Object(b.jsx)(j.b,{path:"/author-frontend/article/:id",children:n||localStorage.getItem("token")?Object(b.jsx)(D,{}):Object(b.jsx)(h,{signal:o})})]})]})}n(46);r.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(P,{})}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.c9a0ddc5.chunk.js.map